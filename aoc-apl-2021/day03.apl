d ← '1'⍷¨↓⍉↑⊃⎕NGET'3.txt' 1
g←(2÷⍨⍴⊃d)<(+/¨d)
b← {+/({2×⍵}⍀⌽)⍵}
⍝part 1
(b g) × (b 0⍷g)
⍝part 2
d←↓⍉↑d
⍝find oxygen
ox←{1=⍴⍵:⍵ ⋄ r←⍵ ⋄ l←⍺ ⋄ nl←⊃¨{⍵⌷r}¨⍸⊃¨{((2÷⍨⍴r)>(+/l⌷¨r))≠⍵}¨l⌷¨r ⋄ (l+1)∇ nl}
⍝find c02
co←{1=⍴⍵:⍵ ⋄ r←⍵ ⋄ l←⍺ ⋄ nl←⊃¨{⍵⌷r}¨⍸⊃¨{((2÷⍨⍴r)≤(+/l⌷¨r))≠⍵}¨l⌷¨r ⋄ (l+1)∇ nl}
×/b¨1(co{⍺,⍵}ox)d
